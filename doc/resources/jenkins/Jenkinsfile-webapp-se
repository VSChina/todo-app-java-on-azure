node {
  stage('init') {
    checkout scm
  }

  stage('build') {
    sh '''
        mvn clean package
        cp src/main/resources/web.config target/web.config
        cp target/todo-app-java-on-azure-1.0-SNAPSHOT.jar target/app.jar 
        zip target/todo.zip target/app.jar target/web.config
    '''
  }

  stage('deploy') {
    azureWebAppPublish azureCredentialsId: env.AZURE_CRED_ID,
                       resourceGroup: env.RES_GROUP, appName: env.WEB_APP, filePath: "target/todo.zip"

  }
}